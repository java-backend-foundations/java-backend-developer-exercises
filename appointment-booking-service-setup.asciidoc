:toc: macro
:sectnums:
:sectnumlevels: 2

= Setting up the Spring Boot Project

toc::[]

== Prerequisites

Ensure you have prepared your development environment as described in the link:preparation.asciidoc[preparation instructions].

== Creating the Spring Boot Application

We'll create a Spring Boot application using Spring Initializr. Follow these steps to generate your project:

. Navigate to the Spring Initializr website: link:https://start.spring.io[https://start.spring.io]
. Configure the project with the following settings:
+
[cols="1,2"]
|===
| Field | Value

| *Project* | Maven Project
| *Language* | Java
| *Spring Boot* | 3.5.6
| *Group* | `com.capgemini.training`
| *Artifact* | `appointment-booking`
| *Description* | `Java Backend Developer Training`
| *Package name* | `com.capgemini.training.appointmentbooking`
| *Packaging* | Jar
| *Java* | 21 (or your JDK version)
|===

. Under *Dependencies*, add:
+
`Spring Boot Actuator`
+
Click the *Generate* button to download your project.

. Extract the downloaded project to a convenient location (e.g., `C:\trainings\java-backend-developer`)

. Build the project using Maven:
+
[source,bash]
----
mvn clean package
----

. Open the project in your IDE:
+
For IntelliJ IDEA, use the following approach:
+
image::images/setup/open-in-intellij.png[Open in IntelliJ]

=== Understanding the Project Structure

Examine the generated project structure. Spring Initializr has created a basic setup with the selected dependencies in the `pom.xml` file. Currently, you have 2 dependencies and 1 plugin:

[source,xml]
----
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-actuator</artifactId>
    </dependency>

    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-test</artifactId>
        <scope>test</scope>
    </dependency>
</dependencies>

<build>
    <plugins>
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
        </plugin>
    </plugins>
</build>
----

[NOTE]
====
*Think about it:* Why do you think Spring Boot includes the test dependency by default? What does this tell us about Spring Boot's philosophy regarding testing?
====

== Configuring the Application

Add the following configuration to the `application.properties` file to enhance actuator endpoint visibility:

[source,properties]
----
management.endpoint.health.show-components=always
management.endpoint.health.show-details=always
management.endpoints.web.exposure.include=*
----

=== Understanding the Configuration

Let's break down what each configuration property does:

* `management.endpoint.health.show-components=always` - Shows health information for all components (databases, message queues, etc.) even when the application is healthy
* `management.endpoint.health.show-details=always` - Displays detailed health information including disk space, database connectivity status, and custom health indicators
* `management.endpoints.web.exposure.include=*` - Exposes all actuator endpoints via HTTP (by default, only `/health` and `/info` are exposed)

[WARNING]
====
Exposing all actuator endpoints (`*`) should only be used in development environments. In production, you should explicitly specify which endpoints to expose for security reasons.
====

[NOTE]
====
*Think about it:* What security implications might arise from exposing all actuator endpoints in a production environment? How would you determine which endpoints are safe to expose?
====

== Testing the Application

=== Running the Application

. Locate the `AppointmentBookingApplication.java` class and run it from your IDE, or use the Maven command:
+
[source,bash]
----
mvn spring-boot:run
----
+
Initially, you'll see output similar to this:
+
[source,console]
----
2025-10-14T14:00:14.128+02:00  INFO 35512 --- [appointment-booking] [           main] c.c.t.a.AppointmentBookingApplication    : Starting AppointmentBookingApplication using Java 21.0.3
2025-10-14T14:00:14.131+02:00  INFO 35512 --- [appointment-booking] [           main] c.c.t.a.AppointmentBookingApplication    : No active profile set, falling back to 1 default profile: "default"
2025-10-14T14:00:15.299+02:00  INFO 35512 --- [appointment-booking] [           main] c.c.t.a.AppointmentBookingApplication    : Started AppointmentBookingApplication in 1.641 seconds

Process finished with exit code 0
----

. Try accessing http://localhost:8080/actuator/health - you'll encounter a connection error:
+
image::images/setup/unable-to-connect-without-spring-boot-starter-web.png[Unable to connect]

=== Resolving the Web Server Issue

The application starts and immediately shuts down because it lacks a web server. Spring Boot applications without web capabilities exit after startup completion.

*Solution:* Add the Spring Web starter dependency to enable HTTP request handling:

[source,xml]
----
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>
----

[IMPORTANT]
====
After modifying `pom.xml`:

* *IDE users:* Sync Maven projects (see image below)
* *Command line users:* Maven automatically uses the updated `pom.xml`

image::images/setup/sync-maven-changes.png[Sync maven changes]
====

After adding the web dependency, restart the application. You should see:

[source,console]
----
2025-10-14T14:16:42.723+02:00  INFO 23176 --- [appointment-booking] [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-10-14T14:16:42.736+02:00  INFO 23176 --- [appointment-booking] [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-10-14T14:16:43.381+02:00  INFO 23176 --- [appointment-booking] [           main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 1 endpoint beneath base path '/actuator'
2025-10-14T14:16:43.446+02:00  INFO 23176 --- [appointment-booking] [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http)
----

Now http://localhost:8080/actuator/health should display:

image::images/setup/actuator-health.png[Health Endpoint]

=== Running Unit Tests

Execute the default Spring Boot test to verify the application context loads correctly:

[source,bash]
----
mvn test
----

This runs the `AppointmentBookingApplicationTests` class, which contains a single test method:

[source,java]
----
@SpringBootTest
class AppointmentBookingApplicationTests {

    @Test
    void contextLoads() {
    }
}
----

==== Understanding the Context Load Test

The `contextLoads()` test method appears empty but serves a crucial purpose:

* *Purpose:* Verifies that the Spring application context can be successfully loaded and all beans can be created without errors
* *What it tests:* 
  - All `@Configuration` classes are valid
  - All `@Component`, `@Service`, `@Repository` beans can be instantiated
  - Dependency injection works correctly
  - No circular dependencies exist
  - Application properties are valid
* *Why it's important:* This test catches configuration errors early, before you deploy or run integration tests

The `@SpringBootTest` annotation:

* Loads the complete Spring application context
* Uses the same configuration as your running application
* Provides a full integration test environment

[NOTE]
====
*Think about it:* Why might this simple test be more valuable than it appears? What types of issues would cause this test to fail even though the method body is empty?
====

=== Exploring Actuator Endpoints

With your application running, explore these actuator endpoints:

* http://localhost:8080/actuator - Lists all available endpoints
* http://localhost:8080/actuator/health - Application health status
* http://localhost:8080/actuator/info - Application information
* http://localhost:8080/actuator/metrics - Application metrics
* http://localhost:8080/actuator/env - Environment properties

==== Using Actuator for Monitoring

Actuator endpoints provide production-ready features:

* *Health checks:* Monitor application and dependency status
* *Metrics:* Track performance, memory usage, and custom metrics
* *Environment info:* View configuration properties and system information
* *Application info:* Display build information, Git commit details

[NOTE]
====
*Think about it:* How could you use these actuator endpoints in a production environment? What information would be most valuable for operations teams?
====

== Repository Setup and Collaboration

*Congratulations!* Your Spring Boot application is now ready for development.

Your trainer will provide access to the Student Repository for implementing solutions during the Java Backend Developer course.

. Clone the repository to your local machine (e.g., `C:\trainings\java-backend-developer-student`)
. Copy all files from your Spring Boot application to the cloned repository
. Test the application in the new location
. Remove the original project files once verified
. Switch to your group's working branch (e.g., `working/group-1`)
. Coordinate with your team to determine who will commit and push changes
. Create a pull request to your group's solution branch (`solution/group-X`)
. Conduct code reviews and synchronize your team's codebase

[NOTE]
====
*Think about it:* What are the benefits of working on a shared codebase versus individual repositories? How does this simulate real-world development practices?
====

== Navigation

[cols="1,1"]
|===
| link:preparation.asciidoc[← Previous: Preparation] | link:appointment-booking-system-specification.asciidoc[Next: Appointment Booking System Specification →]
|===